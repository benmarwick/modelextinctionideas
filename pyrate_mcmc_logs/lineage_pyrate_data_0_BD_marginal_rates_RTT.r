# 1 files combined:
# 	D:\My Documents\My Papers\conferences\SAA2018\modelextinctionideas\pyrate_mcmc_logs/lineage_pyrate_data_0_BD_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

file_path=paste0(getwd(), '/', quote(lineage_pyrate_data_0_BD_marginal_rates))


pdf(file=paste0(file_path, '_RTT.pdf'),width=0.6*9,height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.118984925417886, 0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.118984925417886,0.126413048042145,0.126413048042145,0.126413048042145,0.126413048042145,0.126413048042145,0.126413048042145,0.126413048042145,0.126413048042145,0.126413048042145)
L_hpd_M95=c(0.249989221579806, 0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806,0.249989221579806)
M_hpd_m95=c(0.10724965212778, 0.10724965212778,0.10724965212778,0.071441736878582,0.052996192224562,0.052996192224562,0.028852372339246,0.016638044036367,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.014016462643812,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102,0.007808166370102)
M_hpd_M95=c(0.798312498095988, 0.798312498095988,0.798312498095988,0.449081163718753,0.253037916621907,0.253037916621907,0.242779860943625,0.233573051868133,0.156194643814957,0.156194643814957,0.156194643814957,0.156194643814957,0.156194643814957,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563,0.151565283228563)
R_hpd_m95=c(-0.66602572485718, -0.66602572485718,-0.66602572485718,-0.325993678458258,-0.121536489956074,-0.121536489956074,-0.111197658853093,-0.11030074739698,-0.032262554804792,-0.032262554804792,-0.032262554804792,-0.032262554804792,-0.032262554804792,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656,0.02145105080656)
R_hpd_M95=c(0.098423938351242, 0.098423938351242,0.098423938351242,0.098423938351242,0.098423938351242,0.098423938351242,0.102649054326587,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.118687386461952,0.150678553390675,0.150678553390675,0.150678553390675,0.150678553390675,0.150678553390675,0.150678553390675,0.150678553390675,0.150678553390675,0.130688560486435,0.130688560486435,0.130688560486435,0.118687386461952,0.143070000443643,0.216456219403929,0.216456219403929,0.216456219403929,0.216456219403929,0.216456219403929,0.216456219403929,0.216456219403929,0.216456219403929,0.216456219403929)
L_mean=c(0.139349340711895, 0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.139349340711895,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.143555361488776,0.172033888870727,0.172033888870727,0.172033888870727,0.172033888870727,0.172033888870727,0.172033888870727,0.172033888870727,0.172033888870727,0.172033888870727)
M_mean=c(0.275374379628385, 0.275374379628385,0.275374379628385,0.202687303506644,0.163078806357225,0.163078806357225,0.140660251928959,0.100318376518084,0.067183198602118,0.067183198602118,0.065340941091454,0.065340941091454,0.065340941091454,0.051573293713219,0.051573293713219,0.051573293713219,0.051573293713219,0.052452529010163,0.051252851048788,0.047947010555402,0.045928702205623,0.045928702205623,0.045985459714209,0.045985459714209,0.045985459714209,0.043317969154934,0.043317969154934,0.043317969154934,0.045316968445358,0.045316968445358,0.045316968445358,0.046774743790717,0.044177500050829,0.044177500050829,0.044177500050829,0.045972582422434,0.045972582422434,0.044100754904493,0.046608682387903,0.046608682387903,0.046608682387903,0.046608682387903)
R_mean=c(-0.13602503891649, -0.13602503891649,-0.13602503891649,-0.063337962794749,-0.02372946564533,-0.02372946564533,-0.001310911217064,0.039030964193811,0.072166142109777,0.072166142109777,0.074008399620441,0.074008399620441,0.074008399620441,0.087776046998677,0.087776046998677,0.087776046998677,0.087776046998677,0.086896811701732,0.088096489663107,0.091402330156493,0.097626659283153,0.097626659283153,0.097569901774567,0.097569901774567,0.097569901774567,0.100237392333841,0.100237392333841,0.100237392333841,0.098238393043417,0.098238393043417,0.098238393043417,0.096780617698058,0.099377861437947,0.127856388819899,0.127856388819899,0.126061306448293,0.126061306448293,0.127933133966234,0.125425206482825,0.125425206482825,0.125425206482825,0.125425206482825)
trans=0.5
age=(0:(42-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.27498814373778663), xlim = c(-44.1,2.1), ylab = 'Speciation rate', xlab = 'Ma',main='lineage' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.8781437479055869), xlim = c(-44.1,2.1), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.7326282973428981, 0.2381018413443219), xlim = c(-44.1,2.1), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean, na.rm = TRUE)), xlim = c(-44.1,2.1), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()

