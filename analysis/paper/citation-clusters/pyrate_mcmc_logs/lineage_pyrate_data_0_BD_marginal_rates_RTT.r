# 1 files combined:
# 	D:\My Documents\My Papers\conferences\SAA2018\modelextinctionideas\analysis\paper\scripts\pyrate_mcmc_logs/lineage_pyrate_data_0_BD_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

file_path=paste0(getwd(), '/', quote(lineage_pyrate_data_0_BD_marginal_rates))


pdf(file=paste0(file_path, '_RTT.pdf'),width=0.6*9,height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.013506369041627, 0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.013506369041627,0.030113291559751,0.031657715405477,0.031657715405477,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709,0.058483017178709)
L_hpd_M95=c(0.197184989538276, 0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.197184989538276,0.222646070621506,0.222646070621506,0.222646070621506,0.222646070621506,0.222646070621506,0.222646070621506)
M_hpd_m95=c(0.001662302657853, 0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853,0.001662302657853)
M_hpd_M95=c(0.119193132850266, 0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266,0.119193132850266)
R_hpd_m95=c(0.005488973192161, 0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.005488973192161,0.026794921897041,0.026794921897041,0.026794921897041,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152,0.055268931586152)
R_hpd_M95=c(0.077991856688009, 0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.077991856688009,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.162924919972053,0.217998603229135,0.217998603229135,0.217998603229135,0.217998603229135,0.217998603229135,0.217998603229135)
L_mean=c(0.04451626158436, 0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.04451626158436,0.094724009745152,0.104422228438963,0.104422228438963,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.110928680236443,0.12480649613645,0.12480649613645,0.12480649613645,0.12480649613645,0.12480649613645,0.12480649613645)
M_mean=c(0.015743310998457, 0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457,0.015743310998457)
R_mean=c(0.028772950585903, 0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.028772950585903,0.078980698746695,0.088678917440506,0.088678917440506,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.095185369237987,0.109063185137993,0.109063185137993,0.109063185137993,0.109063185137993,0.109063185137993,0.109063185137993)
trans=0.5
age=(0:(42-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.2449106776836566), xlim = c(-44.1,2.1), ylab = 'Speciation rate', xlab = 'Ma',main='lineage' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.1311124461352926), xlim = c(-44.1,2.1), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.0060378705113771, 0.2397984635520485), xlim = c(-44.1,2.1), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean, na.rm = TRUE)), xlim = c(-44.1,2.1), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()